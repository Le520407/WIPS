# WhatsApp 集成平台 - 配置检查清单

## ✅ 已完成

- [x] 项目结构创建
- [x] 前端应用搭建（React + TypeScript）
- [x] 后端应用搭建（Node.js + Express）
- [x] 依赖包安装
- [x] TypeScript 配置
- [x] 开发服务器启动
- [x] 基础功能实现

## 📋 需要配置的项目

### 1. Meta Developer 设置

#### 创建应用
- [ ] 访问 https://developers.facebook.com/
- [ ] 创建新应用（Business 类型）
- [ ] 记录 App ID: `_______________`
- [ ] 记录 App Secret: `_______________`

#### 添加 WhatsApp 产品
- [ ] 在应用中添加 WhatsApp 产品
- [ ] 完成 WhatsApp 设置向导

#### 获取凭证
- [ ] Business Account ID: `_______________`
- [ ] Phone Number ID: `_______________`
- [ ] Access Token: `_______________`
- [ ] 设置 Verify Token（自定义）: `_______________`

### 2. 环境变量配置

#### server/.env
```env
# 填写从 Meta 获取的凭证
META_APP_ID=_______________
META_APP_SECRET=_______________
META_VERIFY_TOKEN=_______________
WHATSAPP_BUSINESS_ACCOUNT_ID=_______________
WHATSAPP_PHONE_NUMBER_ID=_______________
WHATSAPP_ACCESS_TOKEN=_______________

# 修改 JWT 密钥（重要！）
JWT_SECRET=_______________

# 其他配置（可选）
PORT=3001
CLIENT_URL=http://localhost:5173
```

#### client/.env
```env
VITE_API_URL=http://localhost:3001
VITE_META_APP_ID=_______________  # 与 server/.env 相同
```

### 3. Webhook 配置（可选，用于接收消息）

#### 安装 ngrok
- [ ] 访问 https://ngrok.com/
- [ ] 下载并安装 ngrok
- [ ] 注册账号（免费）

#### 启动隧道
```bash
ngrok http 3001
```
- [ ] 复制 HTTPS URL: `_______________`

#### 在 Meta 配置 Webhook
- [ ] 进入 WhatsApp > Configuration
- [ ] Callback URL: `https://你的ngrok地址/webhooks/whatsapp`
- [ ] Verify Token: 与 `.env` 中的 `META_VERIFY_TOKEN` 相同
- [ ] 订阅字段: 
  - [ ] messages
  - [ ] message_status
- [ ] 点击 "Verify and Save"

### 4. 测试清单

#### 基础测试
- [ ] 访问 http://localhost:5173
- [ ] 页面正常加载
- [ ] 点击 "使用 Facebook 登录"
- [ ] Facebook 授权页面打开

#### API 测试
- [ ] 健康检查: `curl http://localhost:3001/health`
- [ ] 返回 `{"status":"ok",...}`

#### 功能测试（需要先登录）
- [ ] Dashboard 页面显示正常
- [ ] Messages 页面可以输入
- [ ] Templates 页面可以打开创建弹窗

#### Webhook 测试（如果配置了）
- [ ] Meta Webhook 验证成功
- [ ] 发送测试消息到 WhatsApp 号码
- [ ] 服务器收到 Webhook 事件

### 5. 生产环境准备（上线前）

#### 安全
- [ ] 修改 JWT_SECRET 为强随机字符串
- [ ] 使用永久 Access Token（不是临时的）
- [ ] 启用 HTTPS
- [ ] 配置 CORS 白名单

#### 数据库
- [ ] 选择数据库（PostgreSQL/MongoDB）
- [ ] 创建数据库
- [ ] 配置连接字符串
- [ ] 实现数据持久化

#### 部署
- [ ] 选择托管平台
- [ ] 配置环境变量
- [ ] 部署前端应用
- [ ] 部署后端应用
- [ ] 配置域名
- [ ] 更新 Meta Webhook URL

#### 监控
- [ ] 设置错误日志
- [ ] 配置性能监控
- [ ] 设置告警通知

## 🎯 快速开始步骤

如果你现在就想测试，最少需要：

1. **获取 Meta App ID**
   - 创建 Meta 应用
   - 复制 App ID

2. **配置环境变量**
   ```bash
   # server/.env
   META_APP_ID=你的App_ID
   JWT_SECRET=随便一个字符串
   
   # client/.env
   VITE_META_APP_ID=你的App_ID
   ```

3. **重启服务器**
   ```bash
   # 停止当前服务器（Ctrl+C）
   npm run dev
   ```

4. **访问应用**
   - 打开 http://localhost:5173
   - 点击登录按钮测试

## 📞 获取帮助

如果遇到问题：

1. 查看文档
   - [QUICK_START.md](QUICK_START.md) - 快速开始
   - [SETUP.md](SETUP.md) - 详细设置
   - [API_TESTING.md](API_TESTING.md) - API 测试

2. 检查日志
   - 浏览器控制台（F12）
   - 服务器终端输出

3. 常见问题
   - 登录失败: 检查 META_APP_ID
   - API 错误: 检查 Access Token
   - Webhook 失败: 检查 Verify Token

## ✨ 完成后

当所有配置完成后，你将拥有：

- ✅ 完整的 WhatsApp 集成平台
- ✅ Facebook 登录功能
- ✅ 消息发送能力
- ✅ 模板管理系统
- ✅ Webhook 接收消息

开始你的 WhatsApp 集成之旅吧！🚀
